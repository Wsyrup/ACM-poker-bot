//based on cactus kev's algorithm